<div fxLayout="row" >
  <h2 class="fw-bold">Evaluación de Competencias</h2>
</div>

<div
fxLayout.xs="column"
fxLayout.sm="row wrap"
fxLayout.md="row wrap"
fxLayout.lg="row wrap"
fxLayout.xl="row wrap"
class="p-1 pt-0 pb-3"
fxLayoutAlign.xl="space-between"
fxLayoutAlign.lg="space-between"
fxLayoutAlign.md="space-between"
fxLayoutAlign.sm="space-between"
fxLayoutAlign.xs="start"
>
 
  <app-info-collaborator
    [infoCollaborator]="infoCollaborator"
  ></app-info-collaborator>

  <app-status
    [statusName]="infoCollaborator.statusName"
    [statusId]="infoCollaborator.statusId"
  ></app-status>

</div>

<form
    autocomplete="off"
    [formGroup]="evaluateFormGroup"
    (ngSubmit)="confirmFinalizedEvaluation()"
>
  <div
    fxLayout="column"
    class="p-1 pb-0 pt-0"
    formArrayName="componentCollaboratorDetailsEvaluate"
   >
    <mat-accordion multi>
      <ng-container [formGroupName]="i" *ngFor="let evaluateDetail of componentCollaboratorDetailsEvaluate.controls; let i = index">

        <mat-expansion-panel [expanded]="i === 0" >
          <mat-expansion-panel-header>
            <mat-panel-title>
              {{ evaluateDetail.value.subcomponentName }}
            </mat-panel-title>
            <mat-panel-description>
              <section class="selected-option">
                <mat-checkbox 
                  *ngFor="let conductSelected of evaluateDetail.value.componentCollaboratorConductsEvaluate"
                  class="mr-2" 
                  color="primary"
                  (click)="$event.preventDefault()"
                  [checked]="conductSelected.isSelected">
                </mat-checkbox>
              </section>
            </mat-panel-description>
          </mat-expansion-panel-header>
          
          <app-competency-card

            [conducts]="evaluateDetail.value.componentCollaboratorConductsEvaluate"
            formControlName="componentCollaboratorConductsEvaluate"
          >
          </app-competency-card>
        </mat-expansion-panel>
    
      </ng-container> 
    </mat-accordion>
   </div>

   <div
    fxLayout.xs="row wra"
    fxLayout.sm="row wra"
    fxLayout.md="row wrap"
    fxLayout.lg="row wrap"
    fxLayout.xl="row wrap"
    class="p-1 pb-0 pt-3"
    fxLayoutAlign="center center"
    fxLayoutAlign.xs="space-between center"
    fxLayoutGap="10"
    >
    <button 
      mat-mini-fab 
      color="basic" 
      matTooltip="Cancelar"
      type="button" 
      (click)="cancel()"
    >
        <mat-icon>close</mat-icon>
    </button>
    <button 
      mat-mini-fab 
      color="primary" 
      matTooltip="Guardar notas de evaluación"
      type="submit"
      *ngIf="!isStatusCompleted"
    >
      <mat-icon>save</mat-icon>
    </button>
    </div>
</form>

<!-- <pre>{{ evaluateFormGroup.value | json }}</pre> -->