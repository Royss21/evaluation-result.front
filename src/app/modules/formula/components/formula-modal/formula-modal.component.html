<button mat-icon-button class="close-button" mat-dialog-close>
  <mat-icon [inline]="true" class="close-icon">highlight_off</mat-icon>
</button>
<h2  mat-dialog-title>{{ modalTitle }}</h2>
<form
    class="p-3"
    autocomplete="off"
    [formGroup]="formulaFormGroup"
    (ngSubmit)="confirmSave()"
>
    <mat-dialog-content>

        <div
          fxLayout.xs="row wrap"
          fxLayout.sm="row wrap"
          fxLayout.md="row wrap"
          fxLayout.lg="row wrap"
          fxLayout.xl="row wrap"
          fxLayoutAlign="space-center center"
        >

            <div
                fxFlex.xl="50%"
                fxFlex.lg="50%"
                fxFlex.md="50%"
                fxFlex.sm="100%"
                fxFlex.xs="100%"
                class="p-1 pb-0 pt-0"
            >
                <mat-form-field
                    fxFill
                    appearance="outline"
                >
                  <mat-label>Nombre</mat-label>
                  <input
                      name="name"
                      formControlName="name"
                      type="text"
                      autocomplete="off"
                      maxlength="100"
                      matInput
                  >
                  <mat-error *ngIf="controlsForm['name'].hasError('required')">
                      El nombre es <strong>requerido</strong>.
                  </mat-error>
                  <mat-error *ngIf="controlsForm['name'].hasError('maxlength')">
                      Se ha excedido el límite de caracteres
                  </mat-error>
                </mat-form-field>
            </div>

            <div
                fxFlex.xl="50%"
                fxFlex.lg="50%"
                fxFlex.md="50%"
                fxFlex.sm="100%"
                fxFlex.xs="100%"
                class="p-1 pb-0 pt-0"
            >
                <mat-form-field
                    fxFill
                    appearance="outline"
                >
                <mat-label>Descripción</mat-label>
                    <textarea
                        formControlName="description"
                        matInput
                        cdkTextareaAutosize
                        #autosize="cdkTextareaAutosize"
                        cdkAutosizeMinRows="1"
                        cdkAutosizeMaxRows="5"
                    ></textarea>
                </mat-form-field>
            </div>

            <div
                fxFlex="100%"
                class="p-1 pb-2"
            >
            <p>Parametros configurados:</p>
            <div style="padding: 10px; background-color: rgb(121 187 255 / 18%);;border-radius: 5px; margin-bottom: 10px;">
                <div
                    fxLayout.xs="column"
                    fxLayout.sm="column"
                    fxLayout.md="row wrap"
                    fxLayout.lg="row wrap"
                    fxLayout.xl="row wrap"
                    *ngIf="parametersConfigurated.length > 0; else notParametersConfigurated"
                >
                    <div
                        fxFlex.xl="100%"
                        fxFlex.lg="100%"
                        fxFlex.md="100%"
                        fxFlex.sm="100%"
                        fxFlex.xs="100%"
                        style="margin: 0 0 10px 0;"
                        *ngFor="let parameter of parametersConfigurated; index as i"
                    >
                        <span style="font-weight: bold">{{i + 1}} - {{ parameter.name }} :</span>
                        <mat-chip-list>
                            <mat-chip
                                *ngFor="let value of parameter.parametersValue"
                                (click)="copyNameValue(value.name)"
                            >
                                {{ value.name }} &nbsp; {{ (parameter.isInternalConfiguration) ? '' : ' = ' + value.value}}
                                <mat-icon matChipRemove>file_copy</mat-icon>
                            </mat-chip>
                        </mat-chip-list>
                    </div>

                </div>
                <ng-template #notParametersConfigurated>
                        No hay parametros configurados
                </ng-template>
            </div>
            <div matBadge="4" matBadgeOverlap="false" style="font-size:11px">Nota: Solo puede usar la sentencia SI() y la condicional Y()</div>
            </div>

            <div
                fxFlex.xl="100%"
                fxFlex.lg="100%"
                fxFlex.md="100%"
                fxFlex.sm="100%"
                fxFlex.xs="100%"
                class="p-1 pb-0 pt-2"
            >
                <mat-form-field
                    fxFill
                    appearance="outline"
                >
                    <mat-label>Formula</mat-label>
                    <textarea
                        formControlName="formulaReal"
                        matInput
                        cdkTextareaAutosize
                        #autosize="cdkTextareaAutosize"
                        cdkAutosizeMinRows="1"
                        cdkAutosizeMaxRows="5"
                    ></textarea>

                    <mat-error *ngIf="controlsForm['formulaReal'].hasError('required')">
                        La formula es <strong>requerida</strong>.
                    </mat-error>
                    <mat-error *ngIf="controlsForm['formulaReal'].hasError('maxlength')">
                        Se ha excedido el límite de caracteres
                    </mat-error>

                </mat-form-field>
            </div>

        </div>
    </mat-dialog-content>
    <mat-dialog-actions align="center">
        <button
            mat-mini-fab
            color="basic"
            matTooltip="Cerrar"
            type="button"
            (click)="closeModal()"
        >
            <mat-icon>close</mat-icon>
        </button>
        <button
            mat-mini-fab
            color="primary"
            matTooltip="Guardar"
            type="button"
            (click)="confirmSave(false)"
        >
            <mat-icon>save</mat-icon>
        </button>
        <button
            mat-raised-button
            color="primary"
            matTooltip="Guardar y Cerrar"
            type="submit"
        >
            <mat-icon>save</mat-icon> &nbsp;
            <mat-icon>cancel</mat-icon>
        </button>
    </mat-dialog-actions>
    </form>
